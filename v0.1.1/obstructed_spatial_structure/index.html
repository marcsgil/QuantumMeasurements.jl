<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spatial structure of light with obstructions · QuantumMeasurements.jl</title><meta name="title" content="Spatial structure of light with obstructions · QuantumMeasurements.jl"/><meta property="og:title" content="Spatial structure of light with obstructions · QuantumMeasurements.jl"/><meta property="twitter:title" content="Spatial structure of light with obstructions · QuantumMeasurements.jl"/><meta name="description" content="Documentation for QuantumMeasurements.jl."/><meta property="og:description" content="Documentation for QuantumMeasurements.jl."/><meta property="twitter:description" content="Documentation for QuantumMeasurements.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="QuantumMeasurements.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">QuantumMeasurements.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quick_start/">Quick-Start</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../twin_photons_pvm/">Twin Photons</a></li><li><a class="tocitem" href="../twin_photons_prop/">Twin photons with proportional measurement</a></li><li><a class="tocitem" href="../spatial_structure/">Spatial structure of light</a></li><li class="is-active"><a class="tocitem" href>Spatial structure of light with obstructions</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../random_states/">Random State Generation</a></li><li><a class="tocitem" href="../mathematical_foundations/">Mathematical Foundations</a></li><li><a class="tocitem" href="../maximum_likelihood/">Maximum Likelihood Estimation</a></li><li><a class="tocitem" href="../bayesian_inference/">Bayesian Inference</a></li><li><a class="tocitem" href="../proportional_measurements/">Proportional Measurements</a></li></ul></li><li><span class="tocitem">How-to Guides</span><ul><li><a class="tocitem" href="../choosing_methods/">Choosing Estimation Methods</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Spatial structure of light with obstructions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spatial structure of light with obstructions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/marcsgil/QuantumMeasurements.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/marcsgil/QuantumMeasurements.jl/blob/master/examples/obstructed_spatial_structure.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Spatial-structure-of-light-with-obstructions"><a class="docs-heading-anchor" href="#Spatial-structure-of-light-with-obstructions">Spatial structure of light with obstructions</a><a id="Spatial-structure-of-light-with-obstructions-1"></a><a class="docs-heading-anchor-permalink" href="#Spatial-structure-of-light-with-obstructions" title="Permalink"></a></h1><p>This example is similar to <a href="../spatial_structure/">Spatial structure of light</a>, but now we will introduce an obstruction in the spatial structure of light. This will demonstrate how the tomography can still be performed even when the spatial structure is not fully accessible.</p><p>We will use the same packages as before:</p><pre><code class="language-julia hljs">using QuantumMeasurements, LinearAlgebra, StructuredLight, CairoMakie, Random
Random.seed!(1234);</code></pre><p>We now generate the Laguerre-Gauss modes as before, but we will introduce an obstruction in the spatial structure of light. The obstruction will be a horizontal barrier that blocks the light in the middle of the image. In the code, this is achieved by introducing coordinates <code>xs</code> that only cover the right half of the image (x &gt; 0), and <code>ys</code> that cover the full height:</p><pre><code class="language-julia hljs">xs = LinRange(0, 3, 128)
ys = LinRange(-3, 3, 256)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">256-element LinRange{Float64, Int64}:
 -3.0, -2.97647, -2.95294, -2.92941, …, 2.92941, 2.95294, 2.97647, 3.0</code></pre><p>We generate the Laguerre-Gauss modes as before, but now using the new coordinates:</p><pre><code class="language-julia hljs">ϕ₁ = lg(xs, ys, p=1)
ϕ₂ = lg(xs, ys, l=2)

visualize(abs2.(cat(ϕ₁, ϕ₂, dims=3)))</code></pre><img src="73150f2f.png" alt="Example block output"/><p>We can now create a random superposition of these two modes, as before:</p><pre><code class="language-julia hljs">ψs = randn(ComplexF64, 2)
normalize!(ψs)
ψ = ψs[1] * ϕ₁ + ψs[2] * ϕ₂
probs = abs2.(ψ)
normalize!(probs, 1)
visualize(probs)</code></pre><img src="e9d499b6.png" alt="Example block output"/><p>Now, we use a <code>ProportionalMeasurement</code> to perform the tomography to define our measurement, since, now, it is no longer a PVM (Projection Valued Measure) due to the obstruction. This measurement type already takes care of the logic of the obstruction, and performs the necessary normalization. For that reason, we no longer need to multiply by <code>δA</code> (the area of the pixel), as in the previous example. Take a look at the <a href="../proportional_measurements/">Proportional Measurements</a> documentation for more details.</p><pre><code class="language-julia hljs">μ = ProportionalMeasurement([conj.(pair)...] for pair ∈ zip(ϕ₁, ϕ₂))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ProportionalMeasurement{Float64, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}}([3.387074200703723e-9 3.24918837843236e-9 -5.378336146379924e-25 9.565806408938346e-10; 3.383732988063351e-9 3.245574297072491e-9 5.133988913936037e-11 9.556467090267725e-10; … ; 2.804573847887314e-16 9.052583725094138e-19 -2.6711901372210264e-16 8.545734431834812e-17; 2.1489308900133546e-16 -9.244847919072964e-19 -2.0466013701833492e-16 6.551651199538793e-17], ComplexF64[912.2985435847074 + 0.0im 2.997249875600398 + 1.1256637831949402e-13im; 2.997249875600398 - 1.1256637831949402e-13im 905.9408794229564 + 0.0im], ComplexF64[30.20428021960973 + 0.0im 0.09923262046994497 + 3.726835319399924e-15im; 0.0 + 0.0im 30.098688215767663 + 0.0im], ComplexF64[0.033107890429077774 + 0.0im -0.00010915368477049109 - 4.0994363115556395e-18im; 0.0 + 0.0im 0.03322403929471367 + 0.0im])</code></pre><p>Finally, everything is the same as before, we can estimate the state using the <code>LinearInversion</code> method.</p><pre><code class="language-julia hljs">method = LinearInversion()
ρ = estimate_state(probs, μ, method)[1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 Matrix{ComplexF64}:
 0.654302+0.0im        0.465268-0.0985717im
 0.465268+0.0985717im  0.345698+0.0im</code></pre><p>We can now compare the estimated state with the true state. The fidelity should be close to 1, meaning that we have successfully recovered the state.</p><pre><code class="language-julia hljs">fidelity(ρ, ψs) ≈ 1</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../spatial_structure/">« Spatial structure of light</a><a class="docs-footer-nextpage" href="../random_states/">Random State Generation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Sunday 20 July 2025 19:01">Sunday 20 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
