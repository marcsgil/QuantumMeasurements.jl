<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Maximum Likelihood Estimation · QuantumMeasurements.jl</title><meta name="title" content="Maximum Likelihood Estimation · QuantumMeasurements.jl"/><meta property="og:title" content="Maximum Likelihood Estimation · QuantumMeasurements.jl"/><meta property="twitter:title" content="Maximum Likelihood Estimation · QuantumMeasurements.jl"/><meta name="description" content="Documentation for QuantumMeasurements.jl."/><meta property="og:description" content="Documentation for QuantumMeasurements.jl."/><meta property="twitter:description" content="Documentation for QuantumMeasurements.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="QuantumMeasurements.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">QuantumMeasurements.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quick_start/">Quick-Start</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../twin_photons_pvm/">Twin Photons</a></li><li><a class="tocitem" href="../twin_photons_prop/">Twin photons with proportional measurement</a></li><li><a class="tocitem" href="../spatial_structure/">Spatial structure of light</a></li><li><a class="tocitem" href="../obstructed_spatial_structure/">Spatial structure of light with obstructions</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../random_states/">Random State Generation</a></li><li><a class="tocitem" href="../mathematical_foundations/">Mathematical Foundations</a></li><li class="is-active"><a class="tocitem" href>Maximum Likelihood Estimation</a><ul class="internal"><li><a class="tocitem" href="#Theory-and-Motivation"><span>Theory and Motivation</span></a></li><li><a class="tocitem" href="#Key-Advantages"><span>Key Advantages</span></a></li><li><a class="tocitem" href="#Implementation-Details"><span>Implementation Details</span></a></li><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li><li><a class="tocitem" href="#When-to-Use-MLE"><span>When to Use MLE</span></a></li><li><a class="tocitem" href="#Relationship-to-Other-Methods"><span>Relationship to Other Methods</span></a></li><li><a class="tocitem" href="#See-Also"><span>See Also</span></a></li></ul></li><li><a class="tocitem" href="../bayesian_inference/">Bayesian Inference</a></li><li><a class="tocitem" href="../proportional_measurements/">Proportional Measurements</a></li></ul></li><li><span class="tocitem">How-to Guides</span><ul><li><a class="tocitem" href="../choosing_methods/">Choosing Estimation Methods</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li class="is-active"><a href>Maximum Likelihood Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Maximum Likelihood Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/marcsgil/QuantumMeasurements.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/marcsgil/QuantumMeasurements.jl/blob/master/docs/src/maximum_likelihood.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Maximum-Likelihood-Estimation"><a class="docs-heading-anchor" href="#Maximum-Likelihood-Estimation">Maximum Likelihood Estimation</a><a id="Maximum-Likelihood-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Maximum-Likelihood-Estimation" title="Permalink"></a></h1><p>For situations with limited observations (e.g., photocount regime), the maximum likelihood estimator (MLE) is more appropriate than linear inversion. While linear inversion relies on frequency estimates that become unreliable with few observations, MLE works directly with the count data.</p><h2 id="Theory-and-Motivation"><a class="docs-heading-anchor" href="#Theory-and-Motivation">Theory and Motivation</a><a id="Theory-and-Motivation-1"></a><a class="docs-heading-anchor-permalink" href="#Theory-and-Motivation" title="Permalink"></a></h2><p>The maximum likelihood estimator seeks the density operator that maximizes the probability of observing the experimental data:</p><p class="math-container">\[\hat{\rho}_{ML} = \arg\max_{\rho} \mathcal{L}(N_1, \ldots, N_M | \rho)\]</p><p>where the likelihood function for count data is:</p><p class="math-container">\[\mathcal{L}(N_1, \ldots, N_M | \rho) = \prod_{m=1}^M \left[\mathrm{Tr} \left(\Pi_m \rho \right)\right]^{N_m}\]</p><p>Here, <span>$N_m$</span> represents the number of times outcome <span>$m$</span> was observed in the experiment, and the total number of observations is <span>$N = \sum_m N_m$</span>.</p><h2 id="Key-Advantages"><a class="docs-heading-anchor" href="#Key-Advantages">Key Advantages</a><a id="Key-Advantages-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Advantages" title="Permalink"></a></h2><p><strong>Statistical Optimality</strong>: MLE is asymptotically efficient, meaning it achieves the Cramér-Rao bound for large sample sizes, providing the best possible precision given the available data.</p><p><strong>Finite Sample Performance</strong>: Unlike linear inversion, which can produce unphysical results (non-positive matrices) when probabilities are poorly estimated from few counts, MLE directly optimizes over valid density operators, ensuring physical outputs.</p><p><strong>Photocount Compatibility</strong>: MLE naturally handles scenarios with discrete photon counts, making it ideal for single-photon experiments and quantum optics applications where the Poisson statistics of detection events matter.</p><h2 id="Implementation-Details"><a class="docs-heading-anchor" href="#Implementation-Details">Implementation Details</a><a id="Implementation-Details-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-Details" title="Permalink"></a></h2><p>The package implements MLE using the <strong>Accelerated Projected Gradient (APG)</strong> algorithm with adaptive restart, following the approach of [<a href="../references/#PhysRevA_95_062336">3</a>]. The optimization procedure:</p><ol><li><p><strong>Parameterization</strong>: The density operator is parameterized using the Bloch vector representation to ensure the trace condition <span>$\mathrm{Tr}(\rho) = 1$</span>.</p></li><li><p><strong>Positivity Constraint</strong>: During optimization, each step checks if the resulting state remains positive semi-definite. If not, the step is rejected and a smaller step size is used.</p></li><li><p><strong>Convergence</strong>: The algorithm continues until the gradient norm falls below a specified tolerance or the maximum number of iterations is reached.</p></li></ol><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><pre><code class="language-julia hljs">method = MaximumLikelihood()

ρ_est, θ_est = estimate_state(outcomes, μ, method;
                              x₀=zeros(d²-1),     # Initial Bloch vector
                              t=0.4,              # Initial step size  
                              β=0.8)              # Backtracking factor</code></pre><p><strong>Parameters</strong>:</p><ul><li><code>x₀</code>: Initial guess for the Bloch vector (default: maximally mixed state)</li><li><code>t</code>: Initial step size for backtracking line search</li><li><code>β</code>: Reduction factor for backtracking line search</li></ul><h2 id="When-to-Use-MLE"><a class="docs-heading-anchor" href="#When-to-Use-MLE">When to Use MLE</a><a id="When-to-Use-MLE-1"></a><a class="docs-heading-anchor-permalink" href="#When-to-Use-MLE" title="Permalink"></a></h2><p>MLE is particularly recommended for:</p><ul><li><strong>Low photon count experiments</strong> (N &lt; 1000 per measurement setting)</li><li><strong>Single-photon tomography</strong> where Poisson noise dominates</li><li><strong>High-precision applications</strong> where statistical optimality is crucial</li><li><strong>Scenarios where physical constraints must be strictly enforced</strong></li></ul><p>For large sample sizes, linear inversion becomes computationally more efficient and produces similar results. For practical guidance on when to use each method, see <a href="../choosing_methods/#Choosing-Estimation-Methods">Choosing Estimation Methods</a>.</p><h2 id="Relationship-to-Other-Methods"><a class="docs-heading-anchor" href="#Relationship-to-Other-Methods">Relationship to Other Methods</a><a id="Relationship-to-Other-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Relationship-to-Other-Methods" title="Permalink"></a></h2><p>MLE provides a middle ground between <a href="../mathematical_foundations/#linear_inversion">Linear Inversion</a> and full <a href="../bayesian_inference/#Bayesian-Inference">Bayesian Inference</a>:</p><ul><li><strong>vs Linear Inversion</strong>: More robust for small samples, always produces physical states</li><li><strong>vs Bayesian Inference</strong>: Faster computation, but no uncertainty quantification</li></ul><p>For quantum tomography applications, MLE represents the gold standard for point estimation when computational resources are limited but statistical rigor is required.</p><h2 id="See-Also"><a class="docs-heading-anchor" href="#See-Also">See Also</a><a id="See-Also-1"></a><a class="docs-heading-anchor-permalink" href="#See-Also" title="Permalink"></a></h2><ul><li><a href="../mathematical_foundations/#Mathematical-Foundations">Mathematical Foundations</a>: Basic theory and linear inversion methods</li><li><a href="../bayesian_inference/#Bayesian-Inference">Bayesian Inference</a>: Full posterior estimation with uncertainty quantification</li><li><a href="../choosing_methods/#Choosing-Estimation-Methods">Choosing Estimation Methods</a>: Practical guide for method selection</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mathematical_foundations/">« Mathematical Foundations</a><a class="docs-footer-nextpage" href="../bayesian_inference/">Bayesian Inference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Sunday 20 July 2025 15:24">Sunday 20 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
