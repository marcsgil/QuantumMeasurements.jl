<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spatial structure of light · QuantumMeasurements.jl</title><meta name="title" content="Spatial structure of light · QuantumMeasurements.jl"/><meta property="og:title" content="Spatial structure of light · QuantumMeasurements.jl"/><meta property="twitter:title" content="Spatial structure of light · QuantumMeasurements.jl"/><meta name="description" content="Documentation for QuantumMeasurements.jl."/><meta property="og:description" content="Documentation for QuantumMeasurements.jl."/><meta property="twitter:description" content="Documentation for QuantumMeasurements.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="QuantumMeasurements.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">QuantumMeasurements.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quick_start/">Quick-Start</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../twin_photons_pvm/">Twin Photons</a></li><li><a class="tocitem" href="../twin_photons_prop/">Twin photons with proportional measurement</a></li><li class="is-active"><a class="tocitem" href>Spatial structure of light</a><ul class="internal"><li><a class="tocitem" href="#Theory"><span>Theory</span></a></li><li><a class="tocitem" href="#Tomography"><span>Tomography</span></a></li></ul></li><li><a class="tocitem" href="../obstructed_spatial_structure/">Spatial structure of light with obstructions</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../random_states/">Random State Generation</a></li><li><a class="tocitem" href="../mathematical_foundations/">Mathematical Foundations</a></li><li><a class="tocitem" href="../maximum_likelihood/">Maximum Likelihood Estimation</a></li><li><a class="tocitem" href="../bayesian_inference/">Bayesian Inference</a></li><li><a class="tocitem" href="../proportional_measurements/">Proportional Measurements</a></li></ul></li><li><span class="tocitem">How-to Guides</span><ul><li><a class="tocitem" href="../choosing_methods/">Choosing Estimation Methods</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Spatial structure of light</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spatial structure of light</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/marcsgil/QuantumMeasurements.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/marcsgil/QuantumMeasurements.jl/blob/master/examples/spatial_structure.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Spatial-structure-of-light"><a class="docs-heading-anchor" href="#Spatial-structure-of-light">Spatial structure of light</a><a id="Spatial-structure-of-light-1"></a><a class="docs-heading-anchor-permalink" href="#Spatial-structure-of-light" title="Permalink"></a></h1><p>This example demonstrates how to perform the tomography of the spatial structure of light. Although this is not necessarily quantum, the methods provided by QuantumMeasurements can be used to perform this task. For this example, we will also use the package <a href="https://github.com/marcsgil/StructuredLight.jl">StructuredLight.jl</a> for the generation of the structured light patterns, as well as <a href="https://github.com/MakieOrg/Makie.jl">CairoMakie.jl</a> for plotting.</p><pre><code class="language-julia hljs">using QuantumMeasurements, LinearAlgebra, StructuredLight, CairoMakie, Random
Random.seed!(1234);</code></pre><p>One of the most well-known examples of structured light is the Laguerre-Gauss modes. These modes are solutions of the paraxial wave equation in cylindrical coordinates. They are characterized by two indices, <span>$p$</span> and <span>$l$</span>, the first one being the radial index, while the second one is the azimuthal index. We can generate these modes using the <code>lg</code> function from the StructuredLight package.</p><pre><code class="language-julia hljs">rs = LinRange(-3, 3, 256)
ϕ₁ = lg(rs, rs, p=1)
ϕ₂ = lg(rs, rs, l=2)

visualize(abs2.(cat(ϕ₁, ϕ₂, dims=3)))</code></pre><img src="1f912a11.png" alt="Example block output"/><p>We can now create a random superposition of these two modes.</p><pre><code class="language-julia hljs">ψs = randn(ComplexF64, 2)
normalize!(ψs)
ψ = ψs[1] * ϕ₁ + ψs[2] * ϕ₂
probs = abs2.(ψ)
normalize!(probs, 1)
visualize(probs)</code></pre><img src="32dcef1e.png" alt="Example block output"/><p>What we want to do is recover the coefficients <code>ψs</code> from the image. We show now that this is equivalent to quantum state tomography.</p><h2 id="Theory"><a class="docs-heading-anchor" href="#Theory">Theory</a><a id="Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Theory" title="Permalink"></a></h2><p>We first notice that the modes are normalized, i.e., <span>$\int |\psi|^2 dA = 1$</span>:</p><pre><code class="language-julia hljs">δA = step(rs)^2

isapprox(sum(abs2, ϕ₁) * δA, 1, atol=1e-5) &amp;&amp;
isapprox(sum(abs2, ϕ₂) * δA, 1, atol=1e-5) &amp;&amp;
isapprox(sum(abs2, ψ) * δA, 1, atol=1e-5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>Therefore, we can regard <span>$|\psi|^2$</span> as a probability density function. The probability of making a detection in region <span>$R$</span> is given by</p><p class="math-container">\[p(R) = \int_R |\psi(\mathbf{r})|^2 dA \approx \delta A \times |\psi(\mathbf{r_R})|^2\]</p><p>where <span>$\mathbf{r_R}$</span> is any point in <span>$R$</span> and we have made the approximation that the region <span>$R$</span> is small enough that the mode can be considered constant. This is a reasonable approximation for pixels in a camera, for example. By expanding the mode in the basis <span>$\{\phi_1, \phi_2\}$</span>, we have</p><p class="math-container">\[p(R) ≈ \sum_{i,j} ψ_i^* ψ_j \phi_i^*(\mathbf{r}_R) \phi_j(\mathbf{r}_R) \delta A = |\braket{\psi|\phi_R}|^2\]</p><p>where <span>$\phi_R = (\phi_1^*(\mathbf{r}_R), \ \phi_2^*(\mathbf{r}_R)) \times \sqrt{\delta A}$</span>. We see then that the detection probability can be written as the Born rule for a projective measurement in <span>$\phi_R$</span>.</p><h2 id="Tomography"><a class="docs-heading-anchor" href="#Tomography">Tomography</a><a id="Tomography-1"></a><a class="docs-heading-anchor-permalink" href="#Tomography" title="Permalink"></a></h2><p>By having understood that this is a quantum state tomography problem, we can proceed to estimate the state. We assemble our measurement matrix:</p><pre><code class="language-julia hljs">μ = assemble_measurement_matrix([conj.(pair)...] * √δA for pair ∈ zip(ϕ₁, ϕ₂));</code></pre><p>Finally, the measurements are simply the (normalized) intensity.</p><pre><code class="language-julia hljs">method = LinearInversion()
ρ = estimate_state(probs, μ, method)[1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 Matrix{ComplexF64}:
 0.654302+0.0im        0.465268-0.0985717im
 0.465268+0.0985717im  0.345698+0.0im</code></pre><p>We can now compare the estimated state with the true state.</p><pre><code class="language-julia hljs">fidelity(ρ, ψs) ≈ 1</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>We see that the fidelity is close to 1, meaning that we have successfully recovered the state.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../twin_photons_prop/">« Twin photons with proportional measurement</a><a class="docs-footer-nextpage" href="../obstructed_spatial_structure/">Spatial structure of light with obstructions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Sunday 20 July 2025 15:24">Sunday 20 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
